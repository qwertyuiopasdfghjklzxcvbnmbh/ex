<!DOCTYPE html>
<html lang="en" class="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chimera UI – DeepSeek FREE</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

<script>
tailwind.config = {
    darkMode: 'class',
    theme: {
        extend: {
            fontFamily: {
                sans: ['Inter', 'sans-serif'],
                mono: ['JetBrains Mono', 'monospace'],
            }
        }
    }
}
</script>

<style>
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-thumb{background:#27272a;border-radius:3px}
.typing-cursor::after{content:'▋';animation:blink 1s infinite}
@keyframes blink{50%{opacity:0}}
.prose-custom code{background:#27272a;padding:2px 4px;border-radius:4px}
.prose-custom pre{background:#18181b;padding:1rem;border-radius:.5rem}
</style>
</head>

<body class="bg-black text-zinc-400 font-sans h-screen flex flex-col">

<!-- HEADER -->
<div class="h-14 border-b border-zinc-800 flex items-center justify-between px-4">
    <div class="text-white font-medium">Chimera UI</div>
    <div class="text-xs bg-zinc-900 px-3 py-1 rounded">
        deepseek/deepseek-r1:free
    </div>
</div>

<!-- CHAT -->
<div id="chatContainer" class="flex-1 overflow-y-auto p-4">
    <div id="messagesList" class="max-w-3xl mx-auto space-y-6">
        <div id="emptyState" class="text-center text-zinc-500 mt-20">
            How can I help you today?
        </div>
    </div>
</div>

<!-- INPUT -->
<div class="p-4 border-t border-zinc-800">
<form onsubmit="handleSubmit(event)" class="max-w-3xl mx-auto flex gap-2">
    <textarea id="promptInput" rows="1"
        class="flex-1 bg-zinc-925 border border-zinc-800 rounded px-3 py-2 resize-none"
        placeholder="Send a message..."></textarea>
    <button id="sendBtn" disabled
        class="bg-white text-black px-4 rounded disabled:opacity-30">
        Send
    </button>
</form>
</div>

<script>
// ================= CONFIG =================

// ✅ API KEY DIRECT CODE ME (baad me replace karna)
const apiKey = "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"; 
// example later: const apiKey = "sk-or-xxxxxxxxxxxxxxxx";

const model = "deepseek/deepseek-r1:free";
let messageHistory = [];

// ================= ELEMENTS =================
const messagesList = document.getElementById("messagesList");
const emptyState = document.getElementById("emptyState");
const promptInput = document.getElementById("promptInput");
const sendBtn = document.getElementById("sendBtn");
const chatContainer = document.getElementById("chatContainer");

// ================= INPUT =================
promptInput.addEventListener("input",()=>{
    sendBtn.disabled = !promptInput.value.trim();
});

// ================= UI =================
function addUser(msg){
    emptyState.style.display="none";
    const div=document.createElement("div");
    div.className="flex justify-end";
    div.innerHTML=`<div class="bg-zinc-800 text-white px-4 py-2 rounded-xl max-w-[70%]">${escapeHtml(msg)}</div>`;
    messagesList.appendChild(div);
}

function addAI(){
    const div=document.createElement("div");
    const id="ai-"+Date.now();
    div.innerHTML=`
    <div class="flex gap-3">
        <div class="w-8 h-8 rounded-full bg-zinc-900 flex items-center justify-center">✨</div>
        <div id="${id}" class="prose-custom typing-cursor"></div>
    </div>`;
    messagesList.appendChild(div);
    return document.getElementById(id);
}

function scrollBottom(){
    chatContainer.scrollTop = chatContainer.scrollHeight;
}

// ================= SEND =================
async function handleSubmit(e){
    e.preventDefault();
    const text=promptInput.value.trim();
    if(!text) return;

    addUser(text);
    messageHistory.push({role:"user",content:text});
    promptInput.value="";
    sendBtn.disabled=true;

    const aiBox=addAI();
    scrollBottom();

    const response = await fetch("https://openrouter.ai/api/v1/chat/completions",{
        method:"POST",
        headers:{
            "Authorization":`Bearer ${apiKey}`,
            "Content-Type":"application/json",
            "X-Title":"Chimera UI"
        },
        body:JSON.stringify({
            model,
            messages:messageHistory,
            stream:true
        })
    });

    const reader=response.body.getReader();
    const decoder=new TextDecoder();
    let full="";

    while(true){
        const {done,value}=await reader.read();
        if(done) break;
        const chunk=decoder.decode(value);
        for(const line of chunk.split("\n")){
            if(!line.startsWith("data: ")) continue;
            const data=line.slice(6);
            if(data==="[DONE]") break;
            try{
                const json=JSON.parse(data);
                const delta=json.choices?.[0]?.delta?.content;
                if(delta){
                    full+=delta;
                    aiBox.innerHTML=parseMarkdown(full);
                    scrollBottom();
                }
            }catch{}
        }
    }

    aiBox.classList.remove("typing-cursor");
    messageHistory.push({role:"assistant",content:full});
}

// ================= HELPERS =================
function escapeHtml(t){
    return t.replace(/[&<>"]/g,m=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;" }[m]));
}
function parseMarkdown(t){
    let h=escapeHtml(t);
    h=h.replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>");
    h=h.replace(/`([^`]+)`/g,"<code>$1</code>");
    h=h.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>");
    h=h.replace(/\n/g,"<br>");
    return h;
}
</script>

</body>
</html>

